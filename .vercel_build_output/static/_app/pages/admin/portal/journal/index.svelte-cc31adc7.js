import{S as H,i as L,s as T,e as k,j as D,t as y,c as j,a as w,d as g,l as I,g as E,b as m,G as C,f as P,H as p,I as U,h as q,J as N,Y as B}from"../../../../chunks/vendor-244337ad.js";function S(s,e,t){const a=s.slice();return a[3]=e[t],a}function G(s){let e;return{c(){e=y("Draft")},l(t){e=E(t,"Draft")},m(t,a){P(t,e,a)},d(t){t&&g(e)}}}function O(s){let e;return{c(){e=y("Published")},l(t){e=E(t,"Published")},m(t,a){P(t,e,a)},d(t){t&&g(e)}}}function A(s){let e,t,a,d,u=s[3].title+"",r,h,b,f,i;function n(_,c){return _[3].published?O:G}let o=n(s),l=o(s);function v(){return s[2](s[3])}return{c(){e=k("li"),t=k("button"),l.c(),a=D(),d=k("a"),r=y(u),b=D(),this.h()},l(_){e=j(_,"LI",{class:!0});var c=w(e);t=j(c,"BUTTON",{class:!0});var J=w(t);l.l(J),J.forEach(g),a=I(c),d=j(c,"A",{href:!0});var x=w(d);r=E(x,u),x.forEach(g),b=I(c),c.forEach(g),this.h()},h(){m(t,"class","post-status svelte-1ggix2h"),C(t,"published",s[3].published),m(d,"href",h="/admin/portal/journal/edit/"+s[3].id),m(e,"class","svelte-1ggix2h")},m(_,c){P(_,e,c),p(e,t),l.m(t,null),p(e,a),p(e,d),p(d,r),p(e,b),f||(i=U(t,"click",v),f=!0)},p(_,c){s=_,o!==(o=n(s))&&(l.d(1),l=o(s),l&&(l.c(),l.m(t,null))),c&1&&C(t,"published",s[3].published),c&1&&u!==(u=s[3].title+"")&&q(r,u),c&1&&h!==(h="/admin/portal/journal/edit/"+s[3].id)&&m(d,"href",h)},d(_){_&&g(e),l.d(),f=!1,i()}}}function V(s){let e,t,a,d,u,r,h,b,f=s[0],i=[];for(let n=0;n<f.length;n+=1)i[n]=A(S(s,f,n));return{c(){e=k("div"),t=k("h1"),a=y("Journals"),d=D(),u=k("ul");for(let n=0;n<i.length;n+=1)i[n].c();r=D(),h=k("a"),b=y("Create New Post"),this.h()},l(n){e=j(n,"DIV",{class:!0});var o=w(e);t=j(o,"H1",{});var l=w(t);a=E(l,"Journals"),l.forEach(g),d=I(o),u=j(o,"UL",{class:!0});var v=w(u);for(let c=0;c<i.length;c+=1)i[c].l(v);v.forEach(g),r=I(o),h=j(o,"A",{href:!0,class:!0});var _=w(h);b=E(_,"Create New Post"),_.forEach(g),o.forEach(g),this.h()},h(){m(u,"class","svelte-1ggix2h"),m(h,"href","/admin/portal/journal/edit/new"),m(h,"class","link-btn svelte-1ggix2h"),m(e,"class","page-container svelte-1ggix2h")},m(n,o){P(n,e,o),p(e,t),p(t,a),p(e,d),p(e,u);for(let l=0;l<i.length;l+=1)i[l].m(u,null);p(e,r),p(e,h),p(h,b)},p(n,[o]){if(o&3){f=n[0];let l;for(l=0;l<f.length;l+=1){const v=S(n,f,l);i[l]?i[l].p(v,o):(i[l]=A(v),i[l].c(),i[l].m(u,null))}for(;l<i.length;l+=1)i[l].d(1);i.length=f.length}},i:N,o:N,d(n){n&&g(e),B(i,n)}}}async function F({session:s,fetch:e}){return{props:{posts:await(await e("/api/journals")).json()}}}function Y(s,e,t){let{posts:a=[]}=e;async function d(r){const h=!r.published;await fetch(`/api/journals/publish/${r.id}/${h}`);const b=a.findIndex(f=>f.id===r.id);t(0,a[b].published=h,a),t(0,a[b].publishedDate=new Date,a)}const u=r=>d(r);return s.$$set=r=>{"posts"in r&&t(0,a=r.posts)},[a,d,u]}class K extends H{constructor(e){super();L(this,e,Y,V,T,{posts:0})}}export{K as default,F as load};
